<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Valentine v18.1 - Hearts & Pearls</title>

<link href="https://fonts.googleapis.com/css2?family=Annie+Use+Your+Telescope&family=Shantell+Sans:wght@400;700&display=swap" rel="stylesheet">

<!-- ‚úÖ PRELOAD IMAGES -->
<link rel="preload" as="image" href="1.jpeg">
<link rel="preload" as="image" href="2.jpeg">
<link rel="preload" as="image" href="3.jpeg">
<link rel="preload" as="image" href="4.jpeg">
<link rel="preload" as="image" href="5.jpeg">
<link rel="preload" as="image" href="6.jpeg">
<link rel="preload" as="image" href="7.jpeg">
<link rel="preload" as="image" href="8.jpeg">
<link rel="preload" as="image" href="9.jpeg">
<link rel="preload" as="image" href="10.jpeg">

<style>
/* ----- YOUR ORIGINAL CSS (UNCHANGED) ----- */
:root {
--primary: #ff4d6d;
--dark-pink: #ff0a54;
--bg-grad: radial-gradient(circle, #ffb6c1, #ff9a9e, #fad0c4);
}
* { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
body {
font-family:'Shantell Sans', cursive;
background:var(--bg-grad);
height:100vh; width:100vw; overflow:hidden;
display:flex; justify-content:center; align-items:center;
}
canvas#particle-canvas { position:fixed; inset:0; pointer-events:none; z-index:1; }
.stage { display:none; flex-direction:column; align-items:center; width:95%; max-width:400px; z-index:10; text-align:center; height:100vh; justify-content:center; position:relative; }
.stage.active { display:flex; }
/* ---- (rest of your CSS remains exactly same) ---- */
</style>
</head>

<body>

<!-- ‚úÖ AUDIO FIX -->
<audio id="bg-music" preload="auto" playsinline>
<source src="InShot_20260212_214321964.mp3" type="audio/mp3">
</audio>

<canvas id="particle-canvas"></canvas>

<!-- YOUR STAGES (UNCHANGED) -->
<section id="stage-0" class="stage active">
<h1 style="color:white; font-size:2.2rem; margin-bottom:20px;">Hey Love,</h1>
<div id="lyric-display">I have something special for you‚Ä¶</div>
<div class="btn-container">
<button id="ready-btn">Continue</button>
</div>
</section>

<!-- (Stage 1, 2, 3 same as yours ‚Äî no change) -->

<script>
/* ===========================
   YOUR ORIGINAL JS (UNCHANGED)
   + PERFORMANCE ADDITIONS
=========================== */

// --- DATA ---
const lyrics = [
{ time:0.00, text:"I don't know how to say this" },
{ time:4.00, text:"But" },
{ time:7.00, text:"I think you should know this" },
{ time:9.10, text:"All I dream of is your eyes" },
{ time:13.46, text:"All I long for is your touch" },
{ time:17.20, text:"And, darlin', something tells me that's enough, mm" },
{ time:24.23, text:"You can say that I'm a fool" },
{ time:27.63, text:"And I don't know very much" },
{ time:30.95, text:"But I think they call this love" },
{ time:38.00, text:"" }
];

const imgSources = ["1.jpeg","2.jpeg","3.jpeg","4.jpeg","5.jpeg","6.jpeg","7.jpeg","8.jpeg","9.jpeg","10.jpeg"];

// ‚úÖ FORCE IMAGE PRELOAD (NO LOGIC CHANGE)
imgSources.forEach(src => {
const img = new Image();
img.src = src;
});

// --- PARTICLES (UNCHANGED) ---
const pCanvas = document.getElementById('particle-canvas');
const pCtx = pCanvas.getContext('2d');
let particles = [];
const res = () => { pCanvas.width = window.innerWidth; pCanvas.height = window.innerHeight; };
window.addEventListener('resize', res); res();

class P {
constructor(){ this.reset(); }
reset(){
this.x=Math.random()*pCanvas.width;
this.y=pCanvas.height+20;
this.s=Math.random()*15+10;
this.v=Math.random()*1.5+0.5;
this.type=Math.random()>0.4?'üíå':'‚ù§Ô∏è';
this.opacity=Math.random()*0.5+0.5;
}
update(){ this.y-=this.v; if(this.y<-20) this.reset(); }
draw(){ pCtx.globalAlpha=this.opacity; pCtx.font=`${this.s}px serif`; pCtx.fillText(this.type,this.x,this.y); }
}
for(let i=0;i<50;i++) particles.push(new P());
function loop(){ pCtx.clearRect(0,0,pCanvas.width,pCanvas.height); particles.forEach(p=>{p.update();p.draw();}); requestAnimationFrame(loop); }
loop();

// --- INTRO ---
const music=document.getElementById('bg-music');
music.load(); // ‚úÖ AUDIO BUFFER FIX

const lyricBox=document.getElementById('lyric-display');

document.getElementById('ready-btn').onclick=function(){
this.parentElement.style.display='none';
document.querySelector('#stage-0 h1').style.display='none';
music.play();

music.ontimeupdate=()=>{
const currentTime=music.currentTime;
const currentLine=lyrics.filter(l=>currentTime>=l.time).pop();

if(currentLine && lyricBox.innerText!==currentLine.text){
lyricBox.style.opacity=0;
setTimeout(()=>{
lyricBox.innerText=currentLine.text;
lyricBox.style.opacity=1;
},150);
}
if(currentTime>=35.00){
music.ontimeupdate=null;
nextStage(1);
}
};
};

// --- REST OF YOUR JS SAME AS BEFORE ---
// (Stage switching, gallery, slider, scratch etc unchanged)

</script>

</body>
</html>